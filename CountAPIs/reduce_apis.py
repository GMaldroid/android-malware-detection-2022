import json


top = 1000
adware_apis = json.load(open(f"./output/Top_{top}_APIs_in_Adware_600.json", "r"))
banking_apis = json.load(open(f"./output/Top_{top}_APIs_in_Banking_600.json", "r"))
benign_apis = json.load(open(f"./output/Top_{top}_APIs_in_Benign_600.json", "r"))
riskware_apis = json.load(open(f"./output/Top_{top}_APIs_in_Riskware_600.json", "r"))
sms_apis = json.load(open(f"./output/Top_{top}_APIs_in_SMS_600.json", "r"))

adware_api_names = set([api['api_name'] for api in adware_apis])
banking_api_names = set([api['api_name'] for api in banking_apis])
benign_api_names = set([api['api_name'] for api in benign_apis])
riskware_api_names = set([api['api_name'] for api in riskware_apis])
sms_api_names = set([api['api_name'] for api in sms_apis])

all_api_names = list(adware_api_names | banking_api_names | riskware_api_names | sms_api_names | benign_api_names)
print(len(all_api_names))
open(f"./output/Top_{top}_APIs_in_All.json", "w").write(json.dumps(all_api_names, indent=4))
