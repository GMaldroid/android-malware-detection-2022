import json


adware_apis = json.load(open("./output/All_APIs_in_Adware_600.json", "r"))
banking_apis = json.load(open("./output/All_APIs_in_Banking_600.json", "r"))
benign_apis = json.load(open("./output/All_APIs_in_Benign_600.json", "r"))
riskware_apis = json.load(open("./output/All_APIs_in_Riskware_600.json", "r"))
sms_apis = json.load(open("./output/All_APIs_in_SMS_600.json", "r"))

adware_api_names = set(adware_apis.keys())
banking_api_names = set(banking_apis.keys())
benign_api_names = set(benign_apis.keys())
riskware_api_names = set(riskware_apis.keys())
sms_api_names = set(sms_apis.keys())

only_adware_api_names = adware_api_names - banking_api_names - benign_api_names - riskware_api_names - sms_api_names
only_banking_api_names = banking_api_names - adware_api_names - benign_api_names - riskware_api_names - sms_api_names
only_benign_api_names = benign_api_names - adware_api_names - banking_api_names - riskware_api_names - sms_api_names
only_riskware_api_names = riskware_api_names - adware_api_names - banking_api_names - benign_api_names - sms_api_names
only_sms_api_names = sms_api_names - adware_api_names - banking_api_names - benign_api_names - riskware_api_names

only_adware_apis = {k: adware_apis[k] for k in only_adware_api_names}
only_banking_apis = {k: banking_apis[k] for k in only_banking_api_names}
only_benign_apis = {k: benign_apis[k] for k in only_benign_api_names}
only_riskware_apis = {k: riskware_apis[k] for k in only_riskware_api_names}
only_sms_apis = {k: sms_apis[k] for k in only_sms_api_names}

open(f"./output/Only_APIs_in_Adware_600.json", "w").write(json.dumps(only_adware_apis, indent=4))
open(f"./output/Only_APIs_in_Banking_600.json", "w").write(json.dumps(only_banking_apis, indent=4))
open(f"./output/Only_APIs_in_Benign_600.json", "w").write(json.dumps(only_benign_apis, indent=4))
open(f"./output/Only_APIs_in_Riskware_600.json", "w").write(json.dumps(only_riskware_apis, indent=4))
open(f"./output/Only_APIs_in_SMS_600.json", "w").write(json.dumps(only_sms_apis, indent=4))
